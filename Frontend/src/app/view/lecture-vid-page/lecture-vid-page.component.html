
<div class="viewBackground" *ngIf="lecture | async as lecture">
    <app-header class="sticky top-0 z-50" (clickEvent)="navigation($event)" [navigation]="navElements" ></app-header>
    <div class="sticky top-0 z-40" >
        <div *ngIf="auth.user$ | async as user" class="h-[94vh] max-h-full flex flex-col divide-y-2 divide-gray-300">
            <!--header-->
            <div class="viewHeading" *ngIf="course | async as course">
                <h1>{{lecture.title}} - {{course.title}}</h1>
                <span *ngIf="user.role == 'Student'"><h1 class="text-xl md:flex hidden" *ngIf="owner | async as owner">Course Owner: Ms. {{owner.fname}} {{owner.lname}}</h1></span>
              <span *ngIf="user.role == 'Teacher'"><h1 class="text-xl md:flex hidden" (click)="toggleSettings()">Lecture Settings</h1></span>
            </div>

            <style>
                .video-and-chat-container{
                    overflow: hidden;
                    display: flex;
                }
                .video-container {
                    overflow: hidden;
                    display: flex;
                    justify-content: space-evenly;
                }
                .video {
                    height: 100%;
                    width: 177.77777778vh; /* 100 * 16 / 9 */
                    min-width: 100%;
                    min-height: 56.25vw; /* 100 * 9 / 16 */
                }
            </style>
            <div class="video-and-chat-container py-2"  *ngIf="auth.user$ | async as user">
                <div class="video-container w-full ">
                    <video *ngIf="src" (timeupdate)="time($event)" controls controlslist="nodownload">
                        <source src="{{ src }}">
                    </video>
                </div>
                <app-chat *ngIf="showChat" [lid]="lid" [uid]="user.id" [currentTime]="currentTime" class="w-1/2 md:flex hidden"></app-chat>
                <!--Chat within video container
                <div *ngIf="showChat" class="hidden md:flex flex-col w-1/2 bg-gradient-to-tr from-gray-700 divide-y-2 divide-gray-300">
                    <p (click)="getThreads()" class="py-2 w-full flex justify-center text-2xl text-white italic">Chat Box</p>
                    <textarea class=" w-full min-h-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding transition ease-in-out" name="description" id="description" type="text"  placeholder="Type to Chat"></textarea> 
                </div>-->
            </div>


            <!--Description outside of video container-->
            <div class="hidden xs:flex justify-between items-center w-full pb-2">
                <div class="w-full sm:mx-16 mx-8 ">
                    <div class="divide-y-[1px] divide-gray-300">
                        <div class="flex items-center justify-between">
                            <h1 class="text-xl text-white font-semibold">Description</h1> 
                            <button *ngIf="showChat" (click)="toggleChat()" class="chatButton" type="button">Hide Chat</button>
                            <button *ngIf="!showChat" (click)="toggleChat()" class="chatButton" type="button">Expand Chat</button>
                        </div>
                        <div class="text-white font-normal">
                            <p class="text-lg">{{lecture.description}}</p>
                            
                            <ul class="flex justify-between italic text-sm">
                                <p *ngIf="owner | async as owner">Uploaded by: {{owner.fname}} {{owner.lname}}</p>
                                <p>Uploaded on: {{date}}</p>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <ng-container *ngTemplateOutlet="lectureSettings"></ng-container>
    <div>
<div>

<ng-template #lectureSettings>
    <div *ngIf="lectureDialog" class="fade overflow-x-hidden overflow-y-auto fixed inset-0 z-50 justify-center items-center flex">
        <div class="relative my-6 mx-auto w-1/3 min-w-fit">
        <div class="rounded-xl shadow-2xl relative bg-white">
            <!--Heading-->
            <div class="py-5 border-b border-solid border-gray-200 rounded-t">
            <h1 class="text-4xl font-semibold text-center">Make Changes to the Lecture</h1>
            </div>
            <!--Body-->
            <div class="relative p-6 flex-auto">
                <p *ngIf="alert" class=" text-center text-xl text-red-600">{{ alert }}</p>
                <div class="my-4 text-blueGray-500 text-lg leading-relaxed" *ngIf="course | async as course">
                    <form>
                    <ul class="text-center text-base">
        
                        <li><label class="font-medium">Lecture Title</label></li>
                        <li class="py-2"><input #titleInput name="title" id="title" type="text" value="{{ lecture.title }}" class="rounded-md bg-orange-100 shadow appearance-none border font-lg w-6/12 p-2 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></li>
                        <button (click)="changeTitle(course.id, lecture.id)" class="bg-emerald-500 text-white active:bg-emerald-600 font-bold uppercase text-sm px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150" type="button">
                            Save Change
                        </button>

                        <li><label class="font-medium">Lecture Description</label></li>
                        <li class="py-2"><textarea #descInput name="title" id="title" class="rounded-md bg-orange-100 shadow appearance-none border font-lg w-6/12 p-2 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">{{ lecture.description }}</textarea></li>
                        <button (click)="changeDesc(course.id, lecture.id)" class="bg-emerald-500 text-white active:bg-emerald-600 font-bold uppercase text-sm px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150" type="button">
                            Save Change
                        </button>
        
                        <li><label class="font-medium">Course Thumbnail</label></li>
                        <li class="py-2"><input #thumbInput (change)="thumbnailSelected($event)" accept="image/*" name="thumb" id="thumb" type="file" class="rounded-md bg-orange-100 shadow appearance-none border font-lg w-6/12 p-2 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></li>
                        <button *ngIf="thumbSelected" (click)="changeThumbnail(course.id, lecture.id)" class="bg-emerald-500 text-white active:bg-emerald-600 font-bold uppercase text-sm px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150" type="button">
                            Upload Thumbnail
                        </button>
        
                        <br>
                        <button (click)="deleteLecture(course.id, lecture.id)" class="text-red-500 background-transparent font-bold uppercase px-6 py-2 text-sm outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150" type="button" >
                            Delete Lecture
                        </button>
                        </ul>
                    </form>  
                </div>
            </div>
            <!--Footer-->
            <div class="flex items-center justify-end p-6 border-t border-solid border-blueGray-200 rounded-b">
            <button (click)="toggleSettings()" class="text-red-500 background-transparent font-bold uppercase px-6 py-2 text-sm outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150" type="button" >
                Close
            </button>
            </div>
        </div>
        </div>
    </div>
    <div *ngIf="lectureDialog" class="opacity-25 fixed inset-0 z-40 bg-black"></div>
</ng-template>